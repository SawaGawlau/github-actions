# This workflow will do a clean install of node dependencies, 
# build the source code and run tests across different versions of node
name: Build action for node.js

on: # WHAT TRIGGERS GITHUB ACTION
  push #pull_request:
    #branches: [ main ]
   # you can skip that part and react on every push 

jobs: # list of jobs we want to run
  # this workflow contains a single job called "build"
  build: 
    # the type of runner that job will run on
    runs-on: self-hosted # because we are going to work on our virtual private server / ubuntu for linux/windows etc

    strategy:
      matrix:
      # [12.x, 14.x, 16.x] in this case jobs will be done three times - each one for every node version
        node-version: [16.x] 
        # os: [macos-x, windows-x, ubuntu-x] we can specify operating systems 

    # steps represent a sequence of tasks that will be executed as part of the job
    steps:
    - uses: actions/checkout@v2
    - name: Use Node.js ${{ matrix.node-version }}
      uses: actions/setup-node@v1
      with:
        node-version: ${{ matrix.node-version }}
    
    - name: install dependecies
      run: npm install

    - name: compilation of source code into an executable format 
      run: npm run build --if-present

    - name: Run tests
      run: npm run test

